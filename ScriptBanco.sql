drop database biblioteca;

create database biblioteca;

use biblioteca;

create table usuario (
	id uniqueidentifier not null,
	nome varchar(255) not null,
	cpf varchar(14) not null,
	login varchar(50) not null,
	senha varchar(50) not null,
	nascimento date not null,
	constraint pk_usuario primary key (id)
);

create table locatario (
	id uniqueidentifier not null,
	nome varchar(255) not null,
	cpf varchar(14) not null,
	email varchar(255) not null,
	nascimento date not null,
	telefone varchar(255),
	constraint pk_locatario primary key (id)
);

create table editora (
	id uniqueidentifier not null,
	nome varchar(255) not null,
	cnpj varchar(18) not null,
	constraint pk_editora primary key (id)
);

create table autor (
	id uniqueidentifier not null,
	nome varchar(255) not null,
	nascimento date not null,
	falecimento date,
	constraint pk_autor primary key (id)
);

create table obra (
	id uniqueidentifier not null, 
	titulo varchar(255) not null,
	isbn varchar(17) not null, 
	genero varchar(255) not null,
	idautor uniqueidentifier not null,
	ideditora uniqueidentifier not null,
	constraint pk_obra primary key (id),
	constraint fk_obra_autor foreign key (idautor) references autor(id),
	constraint fk_obra_editora foreign key (ideditora) references editora(id)
);

create table livro (
	id uniqueidentifier not null,
	barcode varchar(max),
	idobra uniqueidentifier not null,
	doacao datetime not null,	
	constraint pk_livro primary key (id),
	constraint fk_livro_obra foreign key (idobra) references obra(id)
);

create table movimentacao (
	datamovimentacao datetime not null,
	idlivro uniqueidentifier not null,
	idlocatario uniqueidentifier not null,
	idusuario uniqueidentifier not null,
	tipo varchar(1) not null,
	constraint pk_movimentacao primary key (datamovimentacao, idlivro, idlocatario),
	constraint fk_movimentacao_livro foreign key (idlivro) references livro(id),
	constraint fk_movimentacao_locatario foreign key (idlocatario) references locatario(id),
	constraint fk_movimentacao_usuario foreign key (idusuario) references usuario(id)
);

INSERT INTO autor VALUES 
('6FFED3CA-6D5A-4060-BA72-C1855ED49922', 'Howard Philips Lovecraft','1890-08-20','1937-03-15'),
('2C522697-BC20-4FC2-AC7C-37A590ECDE01', 'Edgar Allan Poe','1809-01-19','1849-10-07'),
('4641F492-BEB2-472B-9BA7-93FA1DD8DF96', 'Patrícia Cabot', '1967-02-01', null),
('458459CF-A79C-49B0-A33E-EF89CF62045F', 'V. E. Schwab', '1987-07-07', null),
('8A2529E8-73D9-4595-BEE7-AF2B288E148E', 'Holly Black', '1971-11-10', null);

INSERT INTO editora VALUES 
('51B72101-DA30-4D8C-9C63-BEB5F13D0228', 'Darkside', '17.285.159/0001-00'),
('2D95A6B8-32C2-4DD1-99DC-58DF5B47731A', 'Ex Machina', '19.355.765/0001-72'),
('2D943A27-5194-4CB5-9F67-C078DFAF0A03', 'Planeta dos Livros', '05.764.236/0001-18'),
('FA35C631-16D7-4303-8494-E2C64A8F4E4D', 'Record', '44.276.105/0001-43'),
('FE8AC43F-2B86-4E8F-896D-E7A3678CC210', 'Novo Conceito', '08.561.869/0001-17'),
('4E675FF1-264D-4694-8AC8-BC74CE2F3F56', 'Companhia das Letras', '55.789.390/0008-99');

INSERT INTO obra VALUES 
('F3C8F600-27B5-412D-B8FB-784850E248BF', 'Contos Reunidos do Mestre do Horror Cosmico', '978-85-67773-10-0', 'horror cosmico', '6FFED3CA-6D5A-4060-BA72-C1855ED49922', '2D95A6B8-32C2-4DD1-99DC-58DF5B47731A'),
('A35DFABE-6BB8-4A3D-B2B5-21D69295EBF2', 'Edgar Allan Poe - Medo Classico', '978-85-94540-24-9', 'horror', '2C522697-BC20-4FC2-AC7C-37A590ECDE01', '51B72101-DA30-4D8C-9C63-BEB5F13D0228'),
('9025D64F-7D1F-4A2F-B2B2-9446A3D379B5', 'H.P. Lovecraft - Medo Classico - Vol. 1', '978-85-94540-78-2', 'horror cosmico', '6FFED3CA-6D5A-4060-BA72-C1855ED49922', '51B72101-DA30-4D8C-9C63-BEB5F13D0228'),
('98A1FD3F-AA63-486E-840D-58483F254FEB', 'Edgar Allan Poe - Vol. 2', '978-85-94541-20-8', 'horror', '2C522697-BC20-4FC2-AC7C-37A590ECDE01', '51B72101-DA30-4D8C-9C63-BEB5F13D0228'),
('807E31EA-5C69-4384-983D-FE0CB8D5B185', 'A Guardiã de Histórias', '978-85-28620-56-6', 'fantasia', '458459CF-A79C-49B0-A33E-EF89CF62045F', 'FA35C631-16D7-4303-8494-E2C64A8F4E4D'),
('5386FD82-A35E-4F9B-B271-CD6EF87FF209', 'O Príncipe Cruel', '978-85-01115-55-3', 'fantasia', '8A2529E8-73D9-4595-BEE7-AF2B288E148E', 'FA35C631-16D7-4303-8494-E2C64A8F4E4D'),
('9D87697F-A22B-4D04-9E7F-9DC83E2C599B', 'O Dueto Sombrio', '978-85-55340-66-6', 'dark fantasy', '458459CF-A79C-49B0-A33E-EF89CF62045F', '4E675FF1-264D-4694-8AC8-BC74CE2F3F56'),
('3B21DD44-9412-4253-A190-CCF6CE40793B', 'Aprendendo a Seduzir', '978-85-76655-09-1', 'romance', '4641F492-BEB2-472B-9BA7-93FA1DD8DF96', '2D943A27-5194-4CB5-9F67-C078DFAF0A03'),
('DC58904F-D20D-4AB3-81A8-95DF811C4F83', 'A Menina Mais Fria de Coldtown', '978-85-81634-03-6', 'romance', '8A2529E8-73D9-4595-BEE7-AF2B288E148E', 'FE8AC43F-2B86-4E8F-896D-E7A3678CC210'),
('60004347-3C4F-4FE1-8168-1F3555C59871', 'Pode Beijar a Noiva', '978-85-42206-76-0', 'romance', '4641F492-BEB2-472B-9BA7-93FA1DD8DF96', '2D943A27-5194-4CB5-9F67-C078DFAF0A03');

INSERT INTO livro VALUES 
('7CC08B9B-E196-4E11-9A91-DAEA49D56E11', null, 'F3C8F600-27B5-412D-B8FB-784850E248BF', '2021-06-06 19:50:26.000'), 
('0F135EE7-DED9-4AC6-A952-030469F46F5D', null, 'F3C8F600-27B5-412D-B8FB-784850E248BF', '2021-06-06 19:50:26.000'), 
('EE4304D0-33F4-462B-9D1F-4EEEED4BA45C', null, 'F3C8F600-27B5-412D-B8FB-784850E248BF', '2021-06-06 19:50:26.000'), 
('140937FC-3589-4235-8BD4-321510340A45', null, 'F3C8F600-27B5-412D-B8FB-784850E248BF', '2021-06-06 19:50:26.000'), 
('494860C7-C610-487B-978F-EE677E1CC93A', null, 'F3C8F600-27B5-412D-B8FB-784850E248BF', '2021-06-06 19:50:26.000'), 
('FE7FBAC2-8C33-4EE5-B90E-0D2D9296CB9D', null, 'F3C8F600-27B5-412D-B8FB-784850E248BF', '2021-06-06 19:50:26.000'), 
('CCB5E10B-4CBE-458E-B1B7-5B895826291D', null, 'F3C8F600-27B5-412D-B8FB-784850E248BF', '2021-06-06 19:50:26.000'), 
('0DFBF9D2-EEEA-4DF6-9514-1721E9F243F0', null, 'F3C8F600-27B5-412D-B8FB-784850E248BF', '2021-06-06 19:50:26.000'), 
('2A323E5A-6759-4DE7-8989-0BF3A2F491FF', null, 'F3C8F600-27B5-412D-B8FB-784850E248BF', '2021-06-06 19:50:26.000'), 
('AF114EE8-AC67-457B-816E-1FD56FA74187', null, 'F3C8F600-27B5-412D-B8FB-784850E248BF', '2021-06-06 19:50:26.000'), 
('A9E1EF6B-33E3-487C-86BF-80D52D86E7E5', null, 'A35DFABE-6BB8-4A3D-B2B5-21D69295EBF2', '2021-06-06 19:50:26.000'), 
('A8D2C105-561F-478E-BC43-7B9DB3F1822F', null, 'A35DFABE-6BB8-4A3D-B2B5-21D69295EBF2', '2021-06-06 19:50:26.000'), 
('90C764C8-7F0D-4CD7-B6C1-F739E42FE829', null, 'A35DFABE-6BB8-4A3D-B2B5-21D69295EBF2', '2021-06-06 19:50:26.000'), 
('F0BE248A-3AEA-45AA-AB11-65358685B8C5', null, 'A35DFABE-6BB8-4A3D-B2B5-21D69295EBF2', '2021-06-06 19:50:26.000'), 
('9EBD3266-4693-4D83-BE19-A6B47E7E2379', null, 'A35DFABE-6BB8-4A3D-B2B5-21D69295EBF2', '2021-06-06 19:50:26.000'), 
('87BC7E56-5D4C-4C05-9D9C-5EBB924C6F71', null, 'A35DFABE-6BB8-4A3D-B2B5-21D69295EBF2', '2021-06-06 19:50:26.000'), 
('F6939961-36D3-415E-B319-FE5EFE772FA6', null, 'A35DFABE-6BB8-4A3D-B2B5-21D69295EBF2', '2021-06-06 19:50:26.000'), 
('4F9C96E6-AF05-4728-A4AC-F0EB382729CB', null, 'A35DFABE-6BB8-4A3D-B2B5-21D69295EBF2', '2021-06-06 19:50:26.000'), 
('8E3B61B8-E64A-416F-A20B-D840450C0A04', null, 'A35DFABE-6BB8-4A3D-B2B5-21D69295EBF2', '2021-06-06 19:50:26.000'), 
('C97DEFEE-B7DA-4CA0-9A1D-D8E38BFE141D', null, 'A35DFABE-6BB8-4A3D-B2B5-21D69295EBF2', '2021-06-06 19:50:26.000'), 
('9D08A812-EEDD-4954-8E6B-96C12AA33954', null, '98A1FD3F-AA63-486E-840D-58483F254FEB', '2021-06-06 19:50:26.000'), 
('CD3DF492-DFDB-402D-BC7D-F505D5FBFDCB', null, '98A1FD3F-AA63-486E-840D-58483F254FEB', '2021-06-06 19:50:26.000'), 
('4C1550C8-7D2D-4080-BBFF-87D8E6248FC0', null, '98A1FD3F-AA63-486E-840D-58483F254FEB', '2021-06-06 19:50:26.000'), 
('1CB6123D-60AE-471B-9CB9-07DB2C4C559F', null, '98A1FD3F-AA63-486E-840D-58483F254FEB', '2021-06-06 19:50:26.000'), 
('E15E8FAA-FF82-4136-93FE-61940FDA05E2', null, '98A1FD3F-AA63-486E-840D-58483F254FEB', '2021-06-06 19:50:26.000'), 
('0A94061B-CBED-479A-BCD6-68CD3949294F', null, '98A1FD3F-AA63-486E-840D-58483F254FEB', '2021-06-06 19:50:26.000'), 
('E70E2265-4AA2-4A03-9630-BD67B6B9C89B', null, '98A1FD3F-AA63-486E-840D-58483F254FEB', '2021-06-06 19:50:26.000'), 
('11EB895F-B7F6-4C28-9C36-866549F06768', null, '98A1FD3F-AA63-486E-840D-58483F254FEB', '2021-06-06 19:50:26.000'), 
('6E21F137-D1E9-4844-BBE7-4F93866162E2', null, '98A1FD3F-AA63-486E-840D-58483F254FEB', '2021-06-06 19:50:26.000'), 
('99E9A81F-6F4A-48EF-BA41-1963263AEB05', null, '98A1FD3F-AA63-486E-840D-58483F254FEB', '2021-06-06 19:50:26.000'), 
('62D55847-C942-48E1-B089-D381EFB3925B', null, '9025D64F-7D1F-4A2F-B2B2-9446A3D379B5', '2021-06-06 19:50:26.000'), 
('3A688065-51BE-46B7-9BA2-479471FB5A70', null, '9025D64F-7D1F-4A2F-B2B2-9446A3D379B5', '2021-06-06 19:50:26.000'), 
('DA9151BF-BCD6-419C-B848-B9FD9E903EFC', null, '9025D64F-7D1F-4A2F-B2B2-9446A3D379B5', '2021-06-06 19:50:26.000'), 
('3BFCF01E-FFC8-4657-A0BF-B89EA5E779FF', null, '9025D64F-7D1F-4A2F-B2B2-9446A3D379B5', '2021-06-06 19:50:26.000'), 
('A364619E-2EED-4E67-8F4D-25387E1127BE', null, '9025D64F-7D1F-4A2F-B2B2-9446A3D379B5', '2021-06-06 19:50:26.000'), 
('B54E1A60-5997-4263-80B4-84CCF1F09240', null, '9025D64F-7D1F-4A2F-B2B2-9446A3D379B5', '2021-06-06 19:50:26.000'), 
('CE3B5B24-6434-4AE6-81F3-BD98DF4574C6', null, '9025D64F-7D1F-4A2F-B2B2-9446A3D379B5', '2021-06-06 19:50:26.000'), 
('5786423D-9481-459C-A394-349E2D53F49E', null, '9025D64F-7D1F-4A2F-B2B2-9446A3D379B5', '2021-06-06 19:50:26.000'), 
('CDD60083-CC41-4127-A00C-EDDCB6BAC676', null, '9025D64F-7D1F-4A2F-B2B2-9446A3D379B5', '2021-06-06 19:50:26.000'), 
('14689EE1-FCD5-4A00-825B-4474D0D6769A', null, '9025D64F-7D1F-4A2F-B2B2-9446A3D379B5', '2021-06-06 19:50:26.000'); 

INSERT INTO locatario VALUES 
('6FE9F684-E850-468F-8D2A-06F73AA7B55F', 'Pedro Cabral', '431.711.978-12', 'phcs93@gmail.com', '1993-09-24', '5513997981407'),
('AFB2FA1F-6F8A-4521-B6F1-2C0CFA743E62', 'Roberto Pinho', '415.285.008-76', 'ropinho@gmail.com', '1965-07-21', NULL);

INSERT INTO usuario VALUES 
('3976EE66-EBB4-4A7A-AAFA-58E3241E0EF7', 'Maria Leitao', '465.083.078-86', 'mgleitao', '19960215', '1996-02-15');

INSERT INTO movimentacao VALUES 
('2021-06-06 20:10:48', '0F135EE7-DED9-4AC6-A952-030469F46F5D', '6FE9F684-E850-468F-8D2A-06F73AA7B55F', '3976EE66-EBB4-4A7A-AAFA-58E3241E0EF7', 'L'),
('2021-06-06 20:15:51', '0F135EE7-DED9-4AC6-A952-030469F46F5D', '6FE9F684-E850-468F-8D2A-06F73AA7B55F', '3976EE66-EBB4-4A7A-AAFA-58E3241E0EF7', 'D');